# Прогнозирование снижения покупательской активности для интернет-магазина

##  О проекте

Проект по разработке модели машинного обучения для прогнозирования снижения покупательской активности клиентов интернет-магазина "В один клик". Создана система персонализированных предложений для удержания ценных клиентов.

##  Цели проекта

- Разработать модель прогнозирования снижения покупательской активности
- Выделить сегменты клиентов для персонализированного подхода
- Предложить меры по увеличению покупательской активности
- Снизить отток постоянных клиентов

##  Данные

### Основные датасеты:
- **market_file.csv** - поведенческие данные клиентов (1300 записей)
- **market_money.csv** - данные о выручке по периодам
- **market_time.csv** - время проведенное на сайте
- **money.csv** - информация о прибыльности клиентов

### Ключевые признаки:
- **Демографические**: Тип сервиса, согласие на рассылку
- **Поведенческие**: Активность на сайте, просмотры категорий
- **Финансовые**: Выручка, прибыльность, акционные покупки
- **Технические**: Ошибки сервиса, неоплаченные товары

##  Технологии

- **Python 3.8+**
- **Pandas** - обработка и анализ данных
- **Scikit-learn** - машинное обучение
- **SHAP** - анализ важности признаков
- **Matplotlib/Seaborn** - визуализация
- **Phik** - анализ корреляций
- **SciPy** - статистический анализ

##  Ключевые этапы работы

### 1. Предобработка данных
- Приведение названий колонок к змеиному формату
- Удаление неявных дубликатов
- Анализ и обработка выбросов
- Валидация типов данных

### 2. Исследовательский анализ
- Анализ распределения количественных признаков
- Исследование категориальных переменных
- Корреляционный анализ (матрица Phik)
- Выявление аномалий в данных

### 3. Объединение данных
- Создание единого датафрейма для моделирования
- Агрегация данных по временным периодам
- Обогащение данных финансовыми показателями

### 4. Построение моделей

#### Использованные модели:
- **LogisticRegression** - лучшая модель (ROC-AUC: 0.91)
- **DecisionTreeClassifier** 
- **KNeighborsClassifier**
- **SVC**

#### Метрики качества:
- **ROC-AUC**: 0.91
- **Accuracy**: 0.85
- **Precision**: 0.82
- **Recall**: 0.78

### 5. Анализ важности признаков (SHAP)
- Ключевые факторы: количество неоплаченных товаров, время на сайте, акционные покупки
- Маловажные признаки: тип сервиса, длительность регистрации

##  Результаты анализа

### Статистика клиентской базы:
- **61%** клиентов сохранили прежний уровень активности
- **Премиум-подписка**: 28% клиентов
- **Стандартная подписка**: 72% клиентов
- **Согласие на рассылку**: 74% клиентов

### Выявленные закономерности:
- Клиенты с 8+ неоплаченными товарами в 97% случаев снижают активность
- Любители акционных покупок приносят среднюю прибыль
- Время на сайте коррелирует с покупательской активностью

##  Сегментация и рекомендации

### Целевой сегмент (53 клиента):
- Высокая вероятность снижения активности (>70%)
- Высокая прибыльность
- Лояльность к рассылкам (70% сегмента)

### Рекомендации по сегментам:

#### 1. **Любители акций** (53 клиента)
- **Предложение**: Персональные промокоды на preferred категории
- **Категории**: Косметика (13), Домашний текстиль (11), Детские товары (9)

#### 2. **Активные пользователи**
- **Предложение**: Увеличение вовлеченности через рекомендации
- **Метрика**: Увеличение просматриваемых страниц с 8 до 12+

#### 3. **Технически проблемные**
- **Решение**: Устранение ошибок сервиса
- **Приоритет**: Клиенты с 4+ ошибками за квартал

### Общие рекомендации:
- Внедрение календаря непрерывных акций
- Персонализированные всплывающие предложения

##  Метрики качества модели

### Лучшая модель: LogisticRegression
- **ROC-AUC**: 0.91
- **Accuracy**: 0.85  
- **Precision**: 0.82
- **Recall**: 0.78
- **F1-Score**: 0.80

### Настройки модели:
- **Скайлер**: MinMaxScaler()
- **Регуляризация**: L1 (Lasso)
- **Сила регуляризации**: C=1
- **Стратегия**: liblinear
